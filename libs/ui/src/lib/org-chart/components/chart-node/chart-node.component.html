<div (click)="onClickNode($event)" [class.oc-is-selected]="isSelected" [id]="datasource.id" class="oc-node">
  <ng-container
    *ngTemplateOutlet="nodeTemplate ? nodeTemplate : defaultNodeTemplate; context:{ datasource:datasource,nodeHeading: nodeHeading, nodeContent: nodeContent }">
  </ng-container>
  <i (click)="toggleChildren()" *ngIf="datasource.children" [ngClass]="{'oc-icon-plus': isCollapsed, 'oc-icon-minus': !isCollapsed}" class="oc-toggle-btn oc-icon"></i>
</div>
<div (@expandCollapse.done)="toggleAnimEnd($event)" (@expandCollapse.start)="toggleAnimStart($event)"
     *ngIf="datasource.children" [@expandCollapse]="isCollapsed ? 'collapsed' : 'expanded'"
     [ngStyle]="ecStyles" class="oc-groups">
  <ng-container *ngFor="let node of datasource.children;let i=index">
    <div *ngIf="i % groupScale === 0" class="oc-group">
      <ng-container *ngFor="let temp of Arr(groupScale);let j=index;">
        <hcm-chart-node (nodeClick)="onNodeClick($event)" *ngIf="i + j < datasource.children.length"
                       [datasource]="datasource.children[i + j]" [groupScale]="groupScale" [nodeContent]="nodeContent"
                       [nodeHeading]="nodeHeading" [nodeTemplate]="nodeTemplate" [select]="select">
        </hcm-chart-node>
      </ng-container>
    </div>
  </ng-container>
</div>

<ng-template #defaultNodeTemplate let-content="nodeContent" let-heading="nodeHeading" let-nodeData="datasource">
  <div class="oc-node-heading">{{nodeData[heading]}}</div>
  <div class="oc-node-content">{{nodeData[content]}}</div>
</ng-template>
