<main *transloco="let t" class="main-page">
  <header>
    <h1>{{ t('domain') }}</h1>
    <div class="flex items-center gap-4">
      <tui-input [formControl]="searchControl" [tuiTextfieldLabelOutside]="true" class="w-64" icon="tuiIconSearch">
        {{ t('searchBy', { value: t('domain') }) }}
      </tui-input>
      <button (click)="upsertDomain(content)" tuiButton>{{ t('createDomain') }}</button>
    </div>
  </header>
  <section class="main-section">
    <div *ngFor="let domain of domains$ | async" class="flex justify-between items-center border-b p-4">
      <div class="flex gap-4">
        <tui-avatar
          [autoColor]="true"
          [avatarUrl]="domain.image || null"
          [text]="domain.tenant?.tenantName || ''"
          size="l"
        ></tui-avatar>
        <div>
          <p class="text-base font-semibold mb-2">{{ domain.tenant?.tenantName }}</p>
          <tui-tag [hoverable]="true" [value]="t(1 | getStatus)" class="approved-tag" size="s"></tui-tag>
        </div>
      </div>
      <button
        (click)="upsertDomain(content, domain)"
        appearance="flat"
        icon="tuiIconEditLarge"
        size="m"
        tuiIconButton
        type="button"
      ></button>
    </div>
  </section>
  <ng-template #content let-observer>
    <form (ngSubmit)="submitDomain(observer)" [formGroup]="$any(form)">
      <formly-form [fields]="fields" [form]="$any(form)" [model]="model" class="formly-gap"></formly-form>
      <div class="flex justify-center gap-6 mt-8">
        <button (click)="observer.complete()" appearance="outline" tuiButton type="button">{{ t('cancel') }}</button>
        <button tuiButton>{{ t('save') }}</button>
      </div>
    </form>
  </ng-template>
</main>
