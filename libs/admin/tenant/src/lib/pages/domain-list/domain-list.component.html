<main *transloco='let t' class='main-page'>
  <header>
    <h1>{{ t('domain') }}</h1>
    <div class='flex items-center gap-4'>
      <tui-input [formControl]='searchControl' [tuiTextfieldLabelOutside]='true' class='w-64' icon='tuiIconSearch'>
        {{ t('searchBy', { value: t('domain') }) }}
      </tui-input>
      <button (click)='upsertDomain(content)' tuiButton>{{ t('createDomain') }}</button>
    </div>
  </header>

  <section *transloco='let t'>
    <ngx-table
      #table
      [columns]='(columns$ | async) || []'
      [configuration]='configuration'
      [data]='(data$ | async) || []'
    >
      <ng-template let-row>
        <ng-container *tuiLet='row as item'>
          <td>{{ item.name }}</td>
          <td>{{ item.domainUrl }}</td>
          <td>
            <tui-tag
              [hoverable]='true'
              [value]='t((item.status === true ? 1 : -1) | getStatus)'
              class="{{ ((item.status === true ? 1 : -1) | getStatus) + '-tag' }}"
            ></tui-tag>
          </td>
          <td>
            <div class='flex items-center'>
              <div class='flex text-gray-400'>
                <button (click)='upsertDomain(content, item.id)'>
                  <tui-svg src='tuiIconEdit'></tui-svg>
                </button>
                <button (click)='deleteDomain(item.id)'>
                  <tui-svg src='tuiIconTrash'></tui-svg>
                </button>
              </div>
            </div>
          </td>
        </ng-container>
      </ng-template>
    </ngx-table>
  </section>

  <ng-template #content let-observer>
    <form (ngSubmit)='submitDomain(observer, this.domainId)' [formGroup]='$any(form)'>
      <formly-form [fields]='fields' [form]='$any(form)' [model]='model' class='formly-gap'></formly-form>
      <div class='flex justify-center gap-6 mt-8'>
        <button (click)='observer.complete()' appearance='outline' tuiButton type='button'>{{ t('cancel') }}</button>
        <button tuiButton>{{ t('save') }}</button>
      </div>
    </form>
  </ng-template>
</main>
