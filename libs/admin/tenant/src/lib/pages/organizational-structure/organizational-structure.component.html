<main *transloco="let t" class="main-page">
  <header>
    <h1>{{ t('organizationalStructure') }}</h1>
    <button (click)="showDialog(content)" appearance="primary" tuiButton>{{ t('addOrganizationalLevel') }}</button>
  </header>
  <section class="main-section">
    <ngx-table [columns]="(columns$ | async) || []" [configuration]="configuration" [data]="(structure$ | async) || []">
      <ng-template let-row>
        <td>{{ row.orgTypeLabel }}</td>
        <td>{{ row.orgType }}</td>
        <td>{{ row.parentOrgTypeLabel?.orgTypeLabel }}</td>
        <td>{{ row.tenant?.tenantName }}</td>
        <td class="flex gap-1">
          <hero-icon (click)="showDialog(content, row)" class="icon-button" name="pencil-alt" type="solid"></hero-icon>
          <hero-icon class="icon-button" name="trash" type="solid"></hero-icon>
        </td>
      </ng-template>
    </ngx-table>
  </section>
  <ng-template #content let-observer>
    <h1 class="font-semibold text-primary">{{ t(model.id ? 'editOrganizationalLevel' : 'addOrganizationalLevel') }}</h1>
    <formly-form [fields]="fields" [form]="$any(form)" [model]="model" class="formly-gap"></formly-form>
    <div class="flex justify-center gap-6 mt-8">
      <button (click)="observer.complete()" appearance="outline" tuiButton>{{ t('cancel') }}</button>
      <button (click)="save(observer)" [disabled]="!form.valid" appearance="primary" tuiButton>
        {{ t('save') }}
      </button>
    </div>
  </ng-template>
</main>
<hcm-prompt #prompt></hcm-prompt>
