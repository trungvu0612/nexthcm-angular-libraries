<div>
  <button (click)="toggleExpanded()" type="button">
    <tui-svg [class.rotated]="!expanded" src="tuiIconSortDown"></tui-svg>
  </button>
  <span class="font-semibold">Service</span>
</div>
<div class="flex-auto">
  <p *ngIf="expanded; else choose" class="font-semibold">Select a service below</p>
  <ng-template #choose>
    <button (click)="toggleExpanded()" *ngIf="!formControl.value; else service" class="text-blue-primary">
      Choose a service
    </button>
    <ng-template #service>{{ formControl.value.name}}</ng-template>
  </ng-template>
  <tui-expand [expanded]="expanded" class="mt-3">
    <ng-template tuiExpandContent>
      <tui-input
        [formControl]="searchControl"
        [tuiTextfieldLabelOutside]="true"
        class="w-1/2 max-w-xs"
        icon="tuiIconSearch"
        tuiTextfieldSize="m"
        >Find a service
      </tui-input>
      <div *ngIf="servicesFiltered$ | async as services" class="grid grid-cols-3 gap-6 mt-6">
        <div *ngFor="let service of services">
          <button (click)="chooseService(service)" class="text-blue-primary font-normal" type="button">
            {{ service.name }}
          </button>
          <tui-hosted-dropdown [content]="content" [tuiDropdownSided]="true" tuiDropdownHover>
            <tui-svg class="text-gray-300" src="tuiIconTooltip"></tui-svg>
            <ng-template #content>
              <p class="max-w-xs px-3 py-2">{{ service.description }}</p>
            </ng-template>
          </tui-hosted-dropdown>
        </div>
      </div>
    </ng-template>
  </tui-expand>
</div>
