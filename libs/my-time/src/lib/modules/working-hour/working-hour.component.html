<div class="page-container">
  <div class="heading-title">Working Hour</div>
  <form (ngSubmit)="onSearch()" [formGroup]="$any(searchForm)" class="object-form-container">
    <div class="grid grid-cols-1 md:grid-cols-2 my-10 text-base gap-6 working-time">
      <div class="working-section relative">
        <div class="shadow-tmp"></div>
        <div class="grid md:grid-cols-2 text-white text-center bg-purple-700 pt-5 pl-5 pr-5 pb-2 rounded-t-lg">
          <div>
            <img class="mx-auto" src="assets/images/finger-white.png" />
          </div>
          <div>
            <div class="font-bold text-xl mb-5">Worked time yesterday</div>
            <div class="mb-3 font-bold text-4xl">{{ myWorkingHour.totalWorkingTime }}</div>
            <div class="mb-5 text-base">
              <img class="inline mr-1" src="assets/images/map-pin.png" />{{ myWorkingHour.userOffice }}
            </div>
          </div>
        </div>
        <div class="grid md:grid-cols-2 text-white text-center bg-purple-700 pt-5 pl-5 pr-5 pb-2 rounded-b-lg">
          <div class="text-base">
            <div class="text-xl">Time in</div>
            <div class="my-3 time-height text-base">{{ myWorkingHour?.timeInYesterday }}</div>
          </div>
          <div class="border-time text-base">
            <div class="text-xl">Time out</div>
            <div class="my-3 time-height text-base">{{ myWorkingHour?.timeOutYesterday }}</div>
          </div>
        </div>
      </div>

      <div class="text-center shadow-md bg-white rounded-lg grid">
        <div class="heading-title flex items-center justify-center">Your working days this month</div>
        <div class="finger-section">
          <span class="text-8xl text-blue-500 font-bold">11.5</span>
          <span class="text-3xl text-gray-400 font-bold">/12</span>
        </div>
      </div>
    </div>

    <div class="working-data">
      <div class="grid grid-cols-2 text-base gap-1">
        <div>
          <div class="text-left inline mr-10">
            <!--            <select class="year-filter appearance-none">-->
            <!--              <option>2021</option>-->
            <!--              <option>2021</option>-->
            <!--            </select>-->
          </div>
          <div class="text-left inline mr-10">
            <!--            <select class="month-filter appearance-none">-->
            <!--              <option>November</option>-->
            <!--              <option>September</option>-->
            <!--            </select>-->
          </div>
          <div class="text-left inline mr-10">
            <!--            <select class="week-filter appearance-none">-->
            <!--              <option>Week 1</option>-->
            <!--              <option>Week 2</option>-->
            <!--            </select>-->
          </div>
        </div>

        <div>
          <div class="col-span-2 filter-search">
            <button
              (click)="workingStatus('all')"
              [class.actived]="!workingMeStatus"
              class="
                focus:outline-none
                hover:bg-blue-500 hover:text-white hover:bg-blue-500
                text-base
                rounded-lg
                pl-5
                pr-5
                pt-1
                pb-1
                inline
                mr-4
              "
            >
              Everyone
            </button>
            <button
              (click)="workingStatus('me')"
              [class.actived]="workingMeStatus"
              class="
                focus:outline-none
                hover:bg-blue-500 hover:text-white hover:bg-blue-500
                text-base
                rounded-lg
                pl-5
                pr-5
                pt-1
                pb-1
                inline
              "
            >
              Only me
            </button>
          </div>
        </div>
      </div>

      <div class="my-3">
        <input
          class="
            searchbar
            px-3
            py-3
            placeholder-blueGray-300
            text-blueGray-600
            relative
            bg-white
            rounded
            text-sm
            border
            outline-none
            focus:outline-none focus:ring
            w-full
          "
          placeholder="Search by CIF, Full Name, Office"
          type="text"
        />
      </div>

      <div class="flex flex-col shadow-md bg-white">
        <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
          <div class="py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8">
            <div class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
              <div *ngIf="workingMeStatus" class="grid-rows-1">
                <div class="grid-cols-12">
                  <table [columns]="onlyme_columns" class="my-8 w-full" tuiTable>
                    <thead>
                      <tr tuiThGroup>
                        <th *tuiHead="'office'" tuiTh>Office</th>
                        <th *tuiHead="'date'" tuiTh>Date</th>
                        <th *tuiHead="'day'" tuiTh>Day</th>
                        <th *tuiHead="'timeIn'" tuiTh>Time In</th>
                        <th *tuiHead="'timeOut'" tuiTh>Time Out</th>
                        <th *tuiHead="'totalWorkingTime'" tuiTh>Total Working Time (h)</th>
                        <th *tuiHead="'workingDay'" tuiTh>Working Day</th>
                        <th *tuiHead="'ot'" tuiTh>OT</th>
                        <th *tuiHead="'onsiteDay'" tuiTh>Onsite Day</th>
                        <th *tuiHead="'leave'" tuiTh>Leave</th>
                        <th *tuiHead="'action'" class="w-32" tuiTh>Action</th>
                      </tr>
                    </thead>
                    <tbody [data]="workingHourDataOnlyMe" tuiTbody>
                      <tr *tuiRow="let req of workingHourDataOnlyMe; let index = index" tuiTr>
                        <td *tuiCell="'office'" tuiTd>{{ req?.userInfo?.office?.name }}</td>
                        <td *tuiCell="'date'" tuiTd>{{ req.trackingDate | date: 'dd/MM/yyyy' }}</td>
                        <td *tuiCell="'day'" tuiTd>{{ req.day }}</td>
                        <td *tuiCell="'timeIn'" tuiTd>
                          <ng-container *ngIf="req?.inTime">{{ secondsToTime(req.inTime) }}</ng-container>
                        </td>
                        <td *tuiCell="'timeOut'" tuiTd>
                          <ng-container *ngIf="req?.outTime">{{ secondsToTime(req.outTime) }}</ng-container>
                        </td>
                        <td *tuiCell="'totalWorkingTime'" tuiTd>{{ req.totalWorkingTime }}</td>
                        <td *tuiCell="'workingDay'" tuiTd>
                          <ng-container *ngIf="req.workingDay === 0">{{ req.workingDay }}</ng-container>
                          <ng-container *ngIf="req.workingDay !== 0">{{ req.workingDay.toFixed(2) }}</ng-container>
                        </td>
                        <td *tuiCell="'ot'" tuiTd>{{ req.ot }}</td>
                        <td *tuiCell="'onsiteDay'" tuiTd>{{ req.onsiteDay }}</td>
                        <td *tuiCell="'leave'" tuiTd>{{ req?.leave?.leaveType?.name }}</td>
                        <td *tuiCell="'action'" tuiTd>
                          <div class="flex">
                            <tui-svg
                              (click)="workingHourDetail(req?.id)"
                              class="mr-2"
                              src="assets/icons/eye.svg"
                            ></tui-svg>
                            <div>
                              <button
                                (click)="requestUpdateTime(req?.id)"
                                appearance="flat"
                                class="
                                  bg-transparent
                                  hover:bg-blue-500
                                  text-blue-700
                                  font-semibold
                                  hover:text-white
                                  py-2
                                  px-4
                                  border border-blue-500
                                  hover:border-transparent
                                  rounded
                                  ml-2
                                "
                                size="s"
                              >
                                Update
                              </button>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <tui-table-pagination
                    (pageChange)="onPage($event)"
                    (sizeChange)="onSize($event)"
                    [size]="size$"
                    [total]="totalLength"
                  ></tui-table-pagination>
                  <p>Current page: {{ page$ | async }}</p>
                </div>
              </div>

              <div *ngIf="!workingMeStatus" class="grid-rows-1">
                <div class="grid-cols-12">
                  <table [columns]="everyone_columns" class="my-8 w-full" tuiTable>
                    <thead>
                      <tr tuiThGroup>
                        <th *tuiHead="'cif'" tuiTh>CIF</th>
                        <th *tuiHead="'fullName'" tuiTh>Full Name</th>
                        <th *tuiHead="'office'" tuiTh>Office</th>
                        <th *tuiHead="'date'" tuiTh>Date</th>
                        <th *tuiHead="'day'" tuiTh>Day</th>
                        <th *tuiHead="'timeIn'" tuiTh>Time In</th>
                        <th *tuiHead="'timeOut'" tuiTh>Time Out</th>
                        <th *tuiHead="'totalWorkingTime'" tuiTh>Total Working Time</th>
                        <th *tuiHead="'workingDay'" tuiTh>Total Working Day</th>
                        <th *tuiHead="'action'" class="w-32" tuiTh>Action</th>
                      </tr>
                    </thead>
                    <tbody [data]="workingHourData" tuiTbody>
                      <tr *tuiRow="let req of workingHourData; let index = index" tuiTr>
                        <td *tuiCell="'cif'" tuiTd>{{ req.userInfo.code }}</td>
                        <td *tuiCell="'fullName'" tuiTd>{{ req?.userInfo?.profile?.fullName }}</td>
                        <td *tuiCell="'office'" tuiTd>{{ req?.userInfo?.office?.name }}</td>
                        <td *tuiCell="'date'" tuiTd>{{ req.trackingDate | date: 'dd/MM/yyyy' }}</td>
                        <td *tuiCell="'day'" tuiTd>{{ req.day }}</td>
                        <td *tuiCell="'timeIn'" tuiTd>
                          <ng-container *ngIf="req?.inTime">{{ secondsToTime(req.inTime) }}</ng-container>
                        </td>
                        <td *tuiCell="'timeOut'" tuiTd>
                          <ng-container *ngIf="req?.outTime">{{ secondsToTime(req.outTime) }}</ng-container>
                        </td>
                        <td *tuiCell="'totalWorkingTime'" tuiTd>{{ req.totalWorkingTime }}</td>
                        <td *tuiCell="'workingDay'" tuiTd>
                          <ng-container *ngIf="req.workingDay === 0">{{ req.workingDay }}</ng-container>
                          <ng-container *ngIf="req.workingDay !== 0">{{ req.workingDay.toFixed(2) }}</ng-container>
                        </td>
                        <td *tuiCell="'action'" tuiTd>
                          <div class="flex">
                            <div>
                              <tui-svg
                                (click)="workingHourDetail(req?.id)"
                                class="mr-2"
                                src="assets/icons/eye.svg"
                              ></tui-svg>
                            </div>
                            <div>
                              <button
                                (click)="requestUpdateTime(req?.id)"
                                appearance="flat"
                                class="
                                  bg-transparent
                                  hover:bg-blue-500
                                  text-blue-700
                                  font-semibold
                                  hover:text-white
                                  py-2
                                  px-4
                                  border border-blue-500
                                  hover:border-transparent
                                  rounded
                                  ml-2
                                "
                                size="s"
                              >
                                Update
                              </button>
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <tui-table-pagination
                    (pageChange)="onPage($event)"
                    (sizeChange)="onSize($event)"
                    [size]="size$"
                    [total]="totalLength"
                  ></tui-table-pagination>
                  <p>Current page: {{ page$ | async }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
