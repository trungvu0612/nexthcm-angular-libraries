<h1 class="text-2xl text-center font-semibold mb-4">Init Map</h1>
<formly-form [fields]="fields" [form]="form" [model]="model" class="flex justify-center flex-wrap mb-4"></formly-form>
<section #zone class="relative ring-4 ring-purple-700">
  <div
    (cdkDragEnded)="moveLine(index, $event.distance.y, 'row')"
    (click)="onClickLine(index)"
    *ngFor="let top of rows; index as index"
    [class.ring-2]="isClicked('row', index)"
    [style]="{ top: top + '%', transform: 'translate3d(0, -50%, 0)' }"
    cdkDrag
    cdkDragBoundary="section"
    class="line rowLine"
  >
    <div></div>
  </div>
  <div
    (cdkDragEnded)="moveLine(index, $event.distance.x, 'column')"
    (click)="onClickLine(index)"
    *ngFor="let left of columns; index as index"
    [class.ring-2]="isClicked('column', index)"
    [style]="{ left: left + '%', transform: 'translate3d(-50%, 0, 0)' }"
    cdkDrag
    cdkDragBoundary="section"
    class="line columnLine"
  >
    <div></div>
  </div>
  <ng-container *ngFor="let row of seatMap; index as y">
    <ng-container *ngFor="let seat of row; index as x">
      <button
        (cdkDragEnded)="moveSeatWithLines(x, y, $event)"
        (cdkDragStarted)="onDragStarted()"
        (click)="toggleSeat(seat)"
        [class.bg-blue-100]="seat.isSeat"
        [style]="{
          top: seat.positionY + '%',
          left: seat.positionX + '%',
          width: dimension[0] + '%',
          height: dimension[1] + '%',
          transform: 'translate3d(-50%, -50%, 0)'
        }"
        cdkDrag
        cdkDragBoundary="section"
        class="seat"
      >
        <tui-svg *ngIf="seat.isSeat; else addSeat" src="tuiIconUser"></tui-svg>
        <ng-template #addSeat>
          <tui-svg src="tuiIconPlus"></tui-svg>
        </ng-template>
      </button>
    </ng-container>
  </ng-container>
  <button
    (cdkDragEnded)="moveSeat(index, $event)"
    *ngFor="let seat of seats; index as index"
    [style]="{
      top: seat.positionY + '%',
      left: seat.positionX + '%',
      width: dimension[0] + '%',
      height: dimension[1] + '%',
      transform: 'translate3d(-50%, -50%, 0)'
    }"
    cdkDrag
    cdkDragBoundary="section"
    class="seat bg-blue-100"
  >
    <tui-svg src="tuiIconUser"></tui-svg>
  </button>
  <img class="w-full h-full" src="https://i.imgur.com/LgjOMhH.png" />
</section>
<button (click)="submit()" [disabled]="!form.valid" class="blue-button mt-4 mx-auto">Submit</button>
